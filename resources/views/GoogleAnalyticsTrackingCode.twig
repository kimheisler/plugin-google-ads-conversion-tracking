{% if config('GoogleAnalytics.consentMode') == 'basic' %}
    {% set permissions = 'granted' %}
{% endif %}

<script type="text/plain" data-cookie-consent="{{ config('GoogleAnalytics.consentGroup') }}.googleAnalytics" async src="https://www.googletagmanager.com/gtag/js?id={{ config("GoogleAnalytics.trackingId") }}"></script>
<script type="text/plain" data-cookie-consent="{{ config('GoogleAnalytics.consentGroup') }}.googleAnalytics">
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}


    gtag('consent', 'default', {
      'ad_storage': '{{ permissions }}',
      'ad_user_data': '{{ permissions }}',
      'ad_personalization': '{{ permissions }}',
      'analytics_storage': '{{ permissions }}'
    });

    gtag('js', new Date());

    gtag('config', '{{ config("GoogleAnalytics.trackingId") }}');


    {% set anonymizeIP = config("GoogleAnalytics.anonymizeIPs") == "true" %}
    {% if anonymizeIP  %}
        gtag('set', 'anonymizeIp', true);
    {% endif %}
</script>
